import{r as o,b,u as z,j as e,m as i,B as N,L as S,e as L,E as C,f as R,q as V}from"./index-CxNXazyc.js";import{a as B}from"./verificationCode-ByXnRRt0.js";const P="_description_8gza9_1",q="_container_8gza9_6",A="_form_8gza9_12",D="_link_8gza9_18",I="_control_8gza9_24",M="_footer_8gza9_31",U="_referrer_8gza9_44",t={description:P,container:q,form:A,link:D,control:I,footer:M,referrer:U};function G(){const[l,h]=o.useState(""),[r,_]=o.useState(""),[s,x]=o.useState(""),[c,w]=o.useState(""),[j,d]=o.useState(!1),[m]=b(["referrer"]),p=m?.referrer?.referrer||"",u=m?.referrer?.user||"",v=z(),E=async a=>{a.preventDefault();try{if(s!==c)throw new Error("Пароли не совпадают");if(!f(r))throw new Error("Невалидный email");if(!p)throw new Error("Регистрация возможна только по приглашению");d(!0);const n=await C({login:l,email:r,password:s,referrer:p}),g=await y(r,s);if(g.error)throw new Error("Ошибка при отправке кода");g.result==="ok"&&v("/email-confirmation",{state:{email:r,password:s},replace:!0})}catch(n){R.error(V(n))}finally{d(!1)}},y=async(a,n)=>await B(a),f=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),k=c===s&&s.length&&r.length&&l.length&&f(r);return e.jsxs("div",{className:t.container,children:[e.jsx("div",{className:t.description}),u&&e.jsxs("div",{className:t.referrer,children:["Вас пригласил(а) ",u]}),e.jsxs("form",{onSubmit:E,className:t.form,children:[e.jsx(i,{value:l,setValue:h,label:"Логин",placeholder:"Введите текст",type:"text",autoComplete:"username"}),e.jsx(i,{value:r,setValue:_,label:"Email",placeholder:"Введите Email",type:"email",autoComplete:"email"}),e.jsx(i,{value:s,setValue:x,label:"Пароль",placeholder:"Введите текст",type:"password",autoComplete:"current-password"}),e.jsx(i,{value:c,setValue:w,label:"Пароль",placeholder:"Введите текст",type:"password"}),e.jsx(N,{disabled:!k,type:"primary",children:"Зарегистрироваться"})]}),e.jsxs("div",{className:t.footer,children:[e.jsx("p",{children:"У вас есть аккаунт?"}),e.jsx(S,{className:t.link,to:"/login",children:"Войти"})]}),j&&e.jsx(L,{})]})}export{G as default};
