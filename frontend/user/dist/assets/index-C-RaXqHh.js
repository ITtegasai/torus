import{r as i,n as y,b as N,u as C,l as L,j as t,B as w,L as b,e as D,K as E,p as S}from"./index-CxNXazyc.js";const B="_description_uons8_1",K="_container_uons8_6",R="_inputs_uons8_12",U="_input_uons8_12",V="_form_uons8_30",I="_link_uons8_36",o={description:B,container:K,inputs:R,input:U,form:V,link:I};function F(){const[M,_]=i.useContext(y),[q,m,z]=N(),l=["","","","","",""],[a,p]=i.useState(l),[d,f]=i.useState(!1),h=C(),k=L(),{email:u,password:g}=k.state||"",c=i.useRef([]),j=(n,s)=>{const{value:e}=n.target;if(isNaN(e))return;const r=[...a];r[s]=e,p(r),e&&s<a.length-1&&c.current[s+1].focus()},v=(n,s)=>{n.key==="Backspace"&&!a[s]&&s>0&&c.current[s-1].focus()},x=async n=>{n.preventDefault();const s=a.join("");try{f(!0);const e=await E({email:u,password:g,code:s}),r=await S({access_token:e.access_token});_(r.result),m("access_token",e.access_token,{path:"/"}),h("/main",{replace:!0})}catch(e){console.log(e),p(l),c.current[0].focus(),alert("Неверный код")}finally{f(!1)}};return i.useEffect(()=>{c.current[0].focus()},[]),t.jsxs("div",{className:o.container,children:[t.jsxs("div",{className:o.description,children:["На вашу почту ",u," отправлен код подтверждения"]}),t.jsxs("form",{onSubmit:x,className:o.form,children:[t.jsx("label",{className:o.label,children:"Код подтверждения"}),t.jsx("div",{className:o.inputs,children:a.map((n,s)=>t.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]",maxLength:"1",value:n,onChange:e=>j(e,s),onKeyDown:e=>v(e,s),ref:e=>c.current[s]=e,className:o.input},s))}),t.jsx(w,{type:"primary",children:"Подтвердить"}),t.jsx(b,{className:o.link,to:"/login",state:{email:u},children:"Назад"})]}),d&&t.jsx(D,{})]})}export{F as default};
